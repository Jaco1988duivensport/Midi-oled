<!DOCTYPE html>
<html>
<head>
  <title>MIDI Configurator</title>
</head>
<body>
  <h1>MIDI Configurator</h1>
  <button id="connect">Connect to Arduino</button>
  <br><br>
  <label for="note">Note:</label>
  <input type="number" id="note" value="60">
  <label for="velocity">Velocity:</label>
  <input type="number" id="velocity" value="127">
  <button id="send">Send MIDI</button>

  <script>
    let device;

    document.getElementById('connect').addEventListener('click', async () => {
      try {
        device = await navigator.usb.requestDevice({ filters: [{ vendorId: 0x2341 }] });
        await device.open();
        await device.selectConfiguration(1);
        await device.claimInterface(0);
        console.log('Device connected');
      } catch (error) {
        console.error('Error: ', error);
      }
    });

    document.getElementById('send').addEventListener('click', async () => {
      if (device) {
        const note = document.getElementById('note').value;
        const velocity = document.getElementById('velocity').value;
        const message = `note:${note} velocity:${velocity}\n`;
        const encoder = new TextEncoder();
        const data = encoder.encode(message);
        await device.transferOut(4, data);
        console.log('MIDI message sent');
      } else {
        console.error('No device connected');
      }
    });
  </script>
</body>
</html>
